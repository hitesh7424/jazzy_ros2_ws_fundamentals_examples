# Pytest for ROS 2 Publisher Node

## Topics Covered

- How to write pytest tests to verify the publisher node is set up correctly.
- Required changes in `CMakeLists.txt` and `package.xml` to enable testing.

## Steps to Set Up and Run Pytest for ROS 2

1. **Install ROS 2 Test Dependencies**

   ```bash
   sudo rosdep init
   rosdep update
   rosdep install --from-paths src --ignore-src -r -y
   ```

2. **Install Pytest**

   ```bash
   sudo apt install python3-pytest
   ```

3. **Make Test Script Executable**

   ```bash
   chmod +x src/ros2_fundamental_examples/test/pytest/test_publisher.py
   ```

4. **Update `CMakeLists.txt` and `package.xml`**
   - Add test dependencies and test entry for pytest in `CMakeLists.txt`:

     ```cmake
     if(BUILD_TESTING)
       find_package(ament_lint_auto REQUIRED)
       find_package(ament_cmake_pytest REQUIRED)
       ament_add_pytest_test(test_publisher test/pytest/test_publisher.py)
     endif()
     ```

   - Add `pytest` and `ament_cmake_pytest` as test dependencies in `package.xml`:

     ```xml
     <test_depend>ament_cmake_pytest</test_depend>
     <test_depend>pytest</test_depend>
     ```

5. **Build the Package**

   ```bash
   colcon build --packages-select ros2_fundamental_examples
   ```

6. **Run the Tests**

   ```bash
   colcon test --packages-select ros2_fundamental_examples
   colcon test --packages-select ros2_fundamental_examples --event-handlers console_direct+
   colcon test-result --all
   colcon test-result --all --verbose
   ```

## Notes

- Ensure your test script is in the correct directory and is executable.
- Review the test results for any failures and debug as needed.
- Use verbose output for detailed test results.
